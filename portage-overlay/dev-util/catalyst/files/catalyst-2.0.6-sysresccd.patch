diff -urN catalyst-2.0.6-a/modules/generic_stage_target.py catalyst-2.0.6-b/modules/generic_stage_target.py
--- catalyst-2.0.6-a/modules/generic_stage_target.py	2008-05-29 05:30:10.000000000 +0100
+++ catalyst-2.0.6-b/modules/generic_stage_target.py	2010-04-03 15:46:58.000000000 +0100
@@ -426,7 +426,7 @@
 
 	def set_snapshot_path(self):
 		self.settings["snapshot_path"]=normpath(self.settings["storedir"]+\
-			"/snapshots/portage-"+self.settings["snapshot"]+".tar.bz2")
+			"/snapshots/portage-"+self.settings["snapshot"]+".tar.xz")
 
 		if os.path.exists(self.settings["snapshot_path"]):
 			self.settings["snapshot_path_hash"]=\
@@ -809,7 +809,7 @@
 			cleanup_errmsg="Error removing existing snapshot directory."
 			cleanup_msg=\
 				"Cleaning up existing portage tree (This can take a long time)..."
-			unpack_cmd="tar xjpf "+self.settings["snapshot_path"]+" -C "+\
+			unpack_cmd="tar xpf "+self.settings["snapshot_path"]+" --xz -C "+\
 				self.settings["chroot_path"]+"/usr"
 			unpack_errmsg="Error unpacking snapshot"
 
@@ -1055,6 +1055,13 @@
 			else:
 				myf.write('CXXFLAGS="${CFLAGS}"\n')
 
+                        myf.write('MAKEOPTS="-j5 --load-average=8"\n')
+                        myf.write('PORTAGE_NICENESS="19"\n')
+                        myf.write('ACCEPT_LICENSE="*"\n')
+                        myf.write('CFLAGS="-Os -mtune=i686 -pipe"\n')
+                        myf.write('CXXFLAGS="-Os -mtune=i686 -pipe"\n')
+                        myf.write('FEATURES="parallel parallel-fetch confcache -collision-protect -protect-owned"\n')
+
 			if self.settings.has_key("LDFLAGS"):
 				myf.write("# LDFLAGS is unsupported.  USE AT YOUR OWN RISK!\n")
 				myf.write('LDFLAGS="'+self.settings["LDFLAGS"]+'"\n')
diff -urN catalyst-2.0.6-a/modules/snapshot_target.py catalyst-2.0.6-b/modules/snapshot_target.py
--- catalyst-2.0.6-a/modules/snapshot_target.py	2008-05-29 05:30:11.000000000 +0100
+++ catalyst-2.0.6-b/modules/snapshot_target.py	2010-04-03 15:46:58.000000000 +0100
@@ -17,7 +17,7 @@
 		self.settings["target_subpath"]="portage"
 		st=self.settings["storedir"]
 		self.settings["snapshot_path"]=normpath(st+"/snapshots/portage-"+self.settings["version_stamp"]\
-			+".tar.bz2")
+			+".tar.xz")
 		self.settings["tmp_path"]=normpath(st+"/tmp/"+self.settings["target_subpath"])
 		if self.settings.has_key("portdir_overlay"):
 			print "\nWarning!!!!"
diff -urN catalyst-2.0.6-a/targets/support/chroot-functions.sh catalyst-2.0.6-b/targets/support/chroot-functions.sh
--- catalyst-2.0.6-a/targets/support/chroot-functions.sh	2008-05-29 05:30:09.000000000 +0100
+++ catalyst-2.0.6-b/targets/support/chroot-functions.sh	2010-04-03 15:46:58.000000000 +0100
@@ -126,6 +126,9 @@
 	else
 		clst_myemergeopts="--quiet"
 	fi
+	# set "--keep-going" to bypass compilation errors and continue
+	clst_myemergeopts="${clst_myemergeopts} -u" # required with >=portage-2.1.7
+	clst_myemergeopts="${clst_myemergeopts} --jobs=1 --load-average=8" # workaround parallel build issues in stage1
 	if [ -n "${clst_FETCH}" ]
 	then
 		export bootstrap_opts="-f"
diff -urN catalyst-2.0.6-a/targets/support/filesystem-functions.sh catalyst-2.0.6-b/targets/support/filesystem-functions.sh
--- catalyst-2.0.6-a/targets/support/filesystem-functions.sh	2008-05-29 05:30:09.000000000 +0100
+++ catalyst-2.0.6-b/targets/support/filesystem-functions.sh	2010-04-03 15:48:05.000000000 +0100
@@ -53,6 +53,7 @@
 create_squashfs() {
 	echo "Creating squashfs..."
 	export loopname="image.squashfs"
+	find ${clst_destpath} -type f -name "*.py?" -exec rm -f {} \;
 	mksquashfs "${clst_destpath}" "$1/${loopname}" ${clst_fsops} -noappend \
 		|| die "mksquashfs failed, did you emerge squashfs-tools?"
 }
diff -urN catalyst-2.0.6-a/targets/support/kmerge.sh catalyst-2.0.6-b/targets/support/kmerge.sh
--- catalyst-2.0.6-a/targets/support/kmerge.sh	2008-05-29 05:30:09.000000000 +0100
+++ catalyst-2.0.6-b/targets/support/kmerge.sh	2010-04-03 15:46:58.000000000 +0100
@@ -99,7 +99,7 @@
 	fi
 	if [ "${clst_kernel_merge}" != "" ]
 	then
-		genkernel --callback="emerge ${gk_callback_opts} ${clst_kernel_merge}" \
+		genkernel --callback="emerge -u --jobs=4 --load-average=8 --accept-properties=-interactive ${gk_callback_opts} ${clst_kernel_merge}" \
 			${GK_ARGS} || exit 1
 	else
 		genkernel ${GK_ARGS} || exit 1
diff -urN catalyst-2.0.6-a/targets/support/unmerge.sh catalyst-2.0.6-b/targets/support/unmerge.sh
--- catalyst-2.0.6-a/targets/support/unmerge.sh	2008-05-29 05:30:09.000000000 +0100
+++ catalyst-2.0.6-b/targets/support/unmerge.sh	2010-04-03 15:46:58.000000000 +0100
@@ -2,6 +2,77 @@
 
 source /tmp/chroot-functions.sh
 
+update_env_settings
+
+DO_EIX=1
+DO_SIZ=0
+DO_LST=0
+
+FILEPATH_PKG='/root/sysresccd-pkg.txt'
+FILEPATH_SIZ='/root/sysresccd-siz.txt'
+FILEPATH_EIX='/root/sysresccd-eix.txt'
+FILEPATH_LST='/root/sysresccd-lst.txt'
+
+# =========================================================================
+# ======================= create the package list =========================
+# =========================================================================
+echo "${clst_packages}" | sed -e "s/ /\n/g" > /root/packages-removed.txt
+equery -q -C list -i | grep -v '^virtual' | grep -v -f /root/packages-removed.txt > ${FILEPATH_PKG}
+
+# -------------------------------------------------------------------------
+if [ -n "(which eix)" ] && [ "${DO_EIX}" = '1' ]
+then
+        echo "---> generating ${FILEPATH_EIX}"
+        /usr/bin/eix-update || echo "eix-update failed"
+        FORMAT='<category>/<name>-<installedversions:VERSION> : <installedversions:FORMAT_INST_USEFLAGS>\n' eix -I -n > /root/eix-temp1.txt
+        cat /root/eix-temp1.txt | grep -v -f /root/packages-removed.txt > /root/eix-temp2.txt
+        cat /root/eix-temp2.txt | grep -v '^virtual' | grep '^[a-z0-9]*-[a-z0-9]*/[a-z0-9]*' > /root/eix-temp3.txt
+        cat /root/eix-temp3.txt | sed -e 's!(!!' -e 's!)!!' -e 's!: $!!g' -e 's! $!!g' > ${FILEPATH_EIX}
+        rm -f /root/eix-temp*.txt
+fi
+
+# -------------------------------------------------------------------------
+if [ -n "(which equery)" ] && [ "${DO_LST}" = '1' ]
+then
+       echo "---> generating ${FILEPATH_LST}"
+       for curpkg in $(cat ${FILEPATH_PKG})
+       do
+               echo "${curpkg}"
+               echo '' >> ${FILEPATH_LST}
+               echo "=========================${curpkg}=========================" >> ${FILEPATH_LST}
+               equery -C files "=${curpkg}" 2>/dev/null | grep '^/' >> ${FILEPATH_LST}
+       done
+fi
+
+# -------------------------------------------------------------------------
+if [ -n "(which equery)" ] && [ "${DO_SIZ}" = '1' ]
+then
+       echo "---> generating ${FILEPATH_SIZ}"
+       for curpkg in $(cat ${FILEPATH_PKG})
+       do
+               pkgfmt=$(echo ${curpkg} | sed -r -e 's!^([A-Za-z0-9-]*)\/([+A-Za-z0-9-]*)-([^-]*)(-r[0-9]){0,2}.*!\1:\2:\3\4 !g')
+               pkgcat=$(echo ${pkgfmt} | cut -d: -f1)
+               pkgnam=$(echo ${pkgfmt} | cut -d: -f2)
+               pkgver=$(echo ${pkgfmt} | cut -d: -f3)
+               sizraw=$(equery -q -C size -b -e ${curpkg} | xargs | sed -r -e 's!.*size\(([0-9]*)\).*!\1!g')
+               sizfmt=$(printf "%0.6d kb" $((sizraw/1024)))
+               output="${sizfmt} --> ${curpkg} --- ${pkgcat}:${pkgnam}:${pkgver}"
+               echo ${output} >> ${FILEPATH_SIZ}
+               echo ${output}
+       done
+fi
+
+# -------------------------------------------------------------------------
+rm -f /root/packages-removed.txt
+# -------------------------------------------------------------------------
+
+# delete the line which contains PORTDIR_OVERLAY in /etc/make.conf (this file is provided with devtools)
+sed -i -e '/PORTDIR_OVERLAY/d' /etc/make.conf
+
+# =========================================================================
+# =========================================================================
+# =========================================================================
+
 run_merge -C ${clst_packages}
 
 exit 0
